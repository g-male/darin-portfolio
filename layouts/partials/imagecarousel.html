<div class="image-container {{ if .Params.images }}hidden{{ end }}">
    <img class="featuredimage" src="{{ .Params.FeaturedImage }}">
    <div class="post-meta">
        <a>{{ .Params.Title }}</a>, {{ .Params.Postyear }}<br>
        <br> <br>
        <a>{{ .Params.descblurb }}</a>
    </div>
</div>

{{ $images := .Params.images }}

{{ if and $images (gt (len $images) 0) }}

    <div class="carousel">
        {{ range $index, $image := $images }}
            <img src="{{ $image.src }}" alt="{{ $image.alt }}" class="{{ if eq $index 0 }}active{{ end }}">
        {{ end }}
        <div class="post-meta">
            <a class="meta-titledate">{{ .Params.Title }}, {{ .Params.Postyear }}</a><br>
            <a class="meta-descblurb">{{ .Params.descblurb }}</a>
        </div>
    </div>

    <div class="thumbnails-container">
        <div class="arrow left-arrow" onclick="changeThumbnailSet(-1)">&#10094;</div>
        <div class="thumbnails">
            {{ range $index, $image := $images }}
                <img src="{{ $image.src }}" alt="{{ $image.alt }}" class="{{ if eq $index 0 }}active{{ end }}" onclick="showSlide({{ $index }})">
            {{ end }}
        </div>
        <div class="arrow right-arrow" onclick="changeThumbnailSet(1)">&#10095;</div>
    </div>

{{ end }}

<script>
let currentSlide = 0;
let currentThumbnailSet = 0;
const slides = document.querySelectorAll('.carousel img');
const thumbnails = document.querySelectorAll('.thumbnails img');
const thumbnailsPerPage = 4;  // Number of thumbnails to show at once

function showSlide(index) {
    slides[currentSlide].classList.remove('active');
    thumbnails[currentSlide].classList.remove('active');
    currentSlide = index;
    slides[currentSlide].classList.add('active');
    thumbnails[currentSlide].classList.add('active');
}

function changeSlide(direction) {
    let newSlide = currentSlide + direction;
    if (newSlide >= slides.length) {
        newSlide = 0;
    } else if (newSlide < 0) {
        newSlide = slides.length - 1;
    }
    showSlide(newSlide);
}

function updateThumbnails() {
    thumbnails.forEach((thumbnail, index) => {
        if (index >= currentThumbnailSet * thumbnailsPerPage && index < (currentThumbnailSet + 1) * thumbnailsPerPage) {
            thumbnail.style.display = 'inline-block';
        } else {
            thumbnail.style.display = 'none';
        }
    });
}

function changeThumbnailSet(direction) {
    let newThumbnailSet = currentThumbnailSet + direction;
    const maxSet = Math.ceil(thumbnails.length / thumbnailsPerPage) - 1;
    if (newThumbnailSet > maxSet) {
        newThumbnailSet = 0;
    } else if (newThumbnailSet < 0) {
        newThumbnailSet = maxSet;
    }
    currentThumbnailSet = newThumbnailSet;
    updateThumbnails();
}

thumbnails.forEach((thumbnail, index) => {
    thumbnail.addEventListener('click', () => showSlide(index));
});

updateThumbnails();  // Initialize thumbnail visibility on page load
</script>
